@using System.Globalization
@model IEnumerable<DesafioMVC.Models.Evento>
@{
    Layout = "_Layout";
    bool Vendendo = true;
}

<div class="container text-center" style="margin-top: 1rem;">
    <h4>EVENTOS</h4>
    <hr>
    @if (Model.Any())
    {
        @foreach (var evento in Model)
        {
            {Vendendo = (evento.QuantidadeIngressos > 0);}
            <div class="row mb-3" style="height: 42.5vh;">
                <div class="col m-0 p-0" style="height: 100%;">
                    <img src="~/Assets/img/@evento.ImagemUrl" class="rounded-left" height="100%" width="100%" >
                </div>
                <div class="col p-0 rounded-right bg-dark text-white" style="height: 100%;">
                    <div style="display: flex; flex-direction: column; flex-wrap: nowrap; justify-content: space-between; height: 100%;">
                        <div class="row" style="flex-wrap: nowrap; flex-direction: column; flex: 1;">
                            <h4 style="margin-top: 1rem;">@evento.Nome.ToUpper() - @evento.Data.ToString("g", CultureInfo.GetCultureInfo("pt-BR")).Substring(0,10)</h4>
                            <h4 style="margin-bottom: 1rem;">@evento.Estabelecimento.Nome</h4>
                        </div>    
                        <div class="row" style="flex: 1;">
                            <div class="col" style="text-align: end;">
                                <p>Valor do ingresso: </p>
                                <p>Horário: </p>
                                <p>Status: </p>
                            </div>
                            <div class="col" style="text-align: start;">
                                <p>@evento.ValorIngresso.ToString("c", CultureInfo.GetCultureInfo("pt-BR"))</p>
                                <p>@evento.Data.ToString("g", CultureInfo.GetCultureInfo("pt-BR")).Substring(10)</p>
                                @if (Vendendo)
                                {
                                <p class="text-success"><b>VENDENDO</b></p>
                                }
                                else
                                {
                                    <p class="text-danger"><b>ESGOTADO</b></p>
                                }
                            </div>
                        </div>
                        @if (Vendendo)
                        {
                            <a class="bg-success text" style="outline: none; flex: 1; display: flex; align-items: center; justify-content: center; text-decoration: none" data-toggle="modal" data-target="#comprar-@evento.Id" href="#@evento.Id">
                                <div>
                                    <h1 class="mb-0 text-white">COMPRAR</h1>
                                </div>
                            </a>
                        }
                    </div>
                </div>
            </div>
            <div class="modal" id="comprar-@evento.Id">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">@evento.Nome.ToUpper() - @evento.Data.ToString("g", CultureInfo.GetCultureInfo("pt-BR")).Substring(0,10)</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>


                        <div class="modal-body" style="text-align: start;">
                            <p>Quantidade</p>
                            <input type="number" class="form-control" id="valorTotal">
                            <p class="mt-3 mb-0">Ingressos disponíveis: <span>@evento.QuantidadeIngressos</span></p>
                              
                        </div>


                        <div class="modal-footer" style="justify-content: space-between;">
                            <div>
                                <h3>Total: R$<span id="totalVenda">0.00</span></h3>
                            </div>
                            <div>
                                <button type="button" class="btn btn-success" id="finalizar">Confirmar</button>
                                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                            </div>
                        </div>
                    </div>
                </div> 
            </div>
        }
    }
</div>
<!-- Modal -->


